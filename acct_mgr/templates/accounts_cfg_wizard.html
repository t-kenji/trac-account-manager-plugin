<!DOCTYPE html
    PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:xi="http://www.w3.org/2001/XInclude"
      xmlns:py="http://genshi.edgewall.org/" 
      xmlns:i18n="http://genshi.edgewall.org/i18n"
      i18n:domain="acct_mgr">
  <xi:include href="layout.html" />
  <head>
    <title>Account Manager Setup</title>
  </head>

  <body>
    <div id="content" class="wizard">
      <div id="progress">
        <!-- Progress bar -->
        <ul class="progress">
          <py:for each="idx,step in enumerate(steps)">
            <li class="${step.past and 'past' or (idx == active and 'active') or None}"
                id="${idx == len(steps) - 1 and 'last' or None}"
                style="${'width:' + str(100 / len(steps)) + '%'}">
              <span>
                <a href="${href(start_href, step=idx)}">${idx + 1}</a>
              </span>
              <a href="${href(start_href, step=idx)}"
                 title="${step.image and step.label or None}">
              <img class="icon" alt="${step.label}" py:if="step.image"
                   heigth="32" width="32"
                   src="${href.chrome('/acct_mgr/' + step.image + '.png')}" />
              <py:if test="not step.image">
                $step.label
              </py:if>
              </a>
            </li>
          </py:for>
        </ul>
      </div>

      <h1>Accounts: Configuration</h1>
      <h2 i18n:msg="step,label">
        Step ${str(active + 1)}: ${steps[active].label}
      </h2>
      <py:choose test="active">
        <div py:when="0">
          <h3>Objective for setting Common Options</h3>
          <p>
            Trac sessions are authenticated per request based on browser
            cookies.  Therefor a number of options control some critical
            browser cookie properties.
          </p>

          <h3>Authentication provider-agnostic options</h3>
          trac:auth_cookie_lifetime [______0] seconds
          <p class="hint">
            Lifetime of the authentication cookie, determines how long the
            browser will cache authentication information, and therefore,
            after how much inactivity a user will have to log in again,
            default (0&nbsp;s) makes cookie expire at browsing sessions end
          </p>

          trac:secure_cookies [_]
          <p class="hint">
            Restrict sending cookies to HTTPS connections, required if your
            Trac instance is only accessible through HTTPS
          </p>

          trac:check_auth_ip [_]
          <p class="hint">
            Whether IP address should be checked for authentication,
            potentially troublesome for users with with dynamic IP adress,
            disregarded for persistant sessions
          </p>

          <h3>Authentication front-end</h3>
          [_] Use HTTP authentication and credentials as configured in and
              provided by your web-server.
          <p class="hint">
            You can still manage some password stores with
            AccountManagerPlugin, if you configure them in the next section.
          </p>
          [x] Use a HTML login form with credentials managed by
              AccountManagerPlugin.
          <div i18n:msg="">
            <p class="hint">
              AccountManagerPlugin provides a form-based login page, even
              integrating links to related actions:
            </p>
            <ul>
              <li><span class="hint">Lost password/Password reset</span></li>
              <li><span class="hint">Registration for new users</span></li>
            </ul>
            <p class="hint">
              accompanied by its own, custom version of LoginModule.
            </p>
            <p class="hint">
              If you enable this feature, you'll want to review and adjust
              some Trac options related to session authentication.
              Note, that AccountManagerPlugin's LoginModule changes the
              default value for auth_cookie_lifetime to 30 days.
            </p>
          </div>

          <!-- py:if acctmgr.LoginModule enabled -->
          <h3>AccountManagerPlugin authentication options</h3>
          account-manager:persistent_sessions [_]
          <p class="hint">
            Keep authentication across browsing sessions without needing to
            re-authenticate, user has to check a "Remember Me" checkbox in
            the AccountManagerPlugin login form (opt-in)
          </p>

          trac:auth_cookie_path [_______]
          <p class="hint">
            Path for authentication cookie, setting this to a common base path
            of several Trac instances to share the cookie providing a cheap
            Single-Sign-On experience and enable AccountManagerPlugin's
            authentication data distribution to Trac instances with matching
            cookie path
          </p>
          <!-- /py:if -->
        </div>

        <div py:when="1">
          <h3>Select a Password Store</h3>
          <img class="icon" alt="Password store icon"
               src="${href.chrome('/acct_mgr/users.png')}" />

        </div>
        <div py:when="2">
          <h3>Define Password Policy</h3>
          <img class="icon" alt="Password refresh icon"
               src="${href.chrome('/acct_mgr/refresh.png')}" />

        </div>
        <div py:when="3">
          <h3>Set account guard options</h3>
          <img class="icon" alt="Account guard icon"
               src="${href.chrome('/acct_mgr/guard.png')}" />

        </div>
        <div py:otherwise="">
          <h3>Review Your Configuration</h3>

        </div>
      </py:choose>
    </div>
  </body>
</html>
